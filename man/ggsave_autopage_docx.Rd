% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ggsave_autopage_docx.R
\name{ggsave_autopage_docx}
\alias{ggsave_autopage_docx}
\title{Auto-paginated, page-fitting saver for \code{facet_wrap()} plots}
\usage{
ggsave_autopage_docx(
  plot,
  file_stem,
  w_per_facet = 2.6,
  h_per_facet = 2.4,
  page_width = 6.5,
  page_height = 9,
  max_col = 4,
  max_row = 5,
  squeeze_one = TRUE,
  dpi = 300,
  units = "in",
  device = ragg::agg_png,
  overwrite = TRUE,
  allow_scale_up = FALSE
)
}
\arguments{
\item{plot}{A \code{ggplot} object that uses \code{facet_wrap()}.}

\item{file_stem}{Character scalar used as the filename stem. Files are saved
as \code{paste0(file_stem, '_p\%02d.png')} by default.}

\item{w_per_facet}{Numeric, target width (inches) allocated per facet
before page fitting. Default \code{2.6}.}

\item{h_per_facet}{Numeric, target height (inches) allocated per facet
before page fitting. Default \code{2.4}.}

\item{page_width, page_height}{Numerics giving the maximum content box size
(inches) to fit each page into. For US Letter with 1" margins, use
\code{page_width = 6.5}, \code{page_height = 9.0}. Defaults are 6.5 and 9.0.}

\item{max_col, max_row}{Integers giving the maximum number of columns and rows
per page. Defaults \code{max_col = 4}, \code{max_row = 5}.}

\item{squeeze_one}{Logical. If \code{TRUE}, and the total number of panels is
exactly one more than the page capacity (\code{max_col * max_row + 1}),
the function will first try to squeeze by adding one extra row or column
to keep everything on a single page. Default \code{TRUE}.}

\item{dpi}{Numeric dots-per-inch passed to \code{ggplot2::ggsave()}. Default 300.}

\item{units}{Units for \code{ggplot2::ggsave()} size arguments. Default \code{"in"}.}

\item{device}{Graphics device function or name. Default \code{ragg::agg_png}
for high-quality anti-aliased PNGs. Set \code{NULL} to let \code{ggsave()}
choose based on filename.}

\item{overwrite}{Logical; if \code{FALSE}, stop if any target file exists.
Default \code{TRUE}.}

\item{allow_scale_up}{Logical; if \code{FALSE}, the plot will only be shrunk
to fit the page box, never enlarged. Default \code{FALSE}.}
}
\value{
(Invisibly) a list with details:
\itemize{
  \item \code{files}: character vector of saved file paths
  \item \code{npanels}: total number of panels in the original plot
  \item \code{pages}: number of pages saved
  \item \code{layout}: c(ncol, nrow) used per page
  \item \code{page_box}: c(width, height) page content box
  \item \code{natural_size}: c(width, height) before fit-to-page scaling
  \item \code{fitted_size}: c(width, height) passed to \code{ggsave()}
  \item \code{scale}: scalar scale factor applied to fit the page
}
}
\description{
Saves a faceted ggplot to one or more image files, automatically paginating
when the number of facets exceeds a per-page limit. Each saved page is sized
to fit within a specified page content box (e.g., Word/PowerPoint/LaTeX
printable area) while preserving aspect ratio.

Works with \code{facet_wrap()} plots (not \code{facet_grid}). If the plot
has no facets, a single page is saved.
}
\details{
Save a faceted ggplot with automatic pagination sized for Word/PDF pages
}
\section{Notes}{

- If the fitted scale factor drops below ~0.6 on a single page, a warning is
  issued (you may wish to paginate or reduce per-facet size).
- This function respects the plot's current \code{scales} setting
  (e.g., \code{"fixed"}, \code{"free_y"}), reusing it for pagination.
}

\examples{
\dontrun{
library(ggplot2)
library(dplyr)

p <- ggplot(mtcars, aes(disp, mpg)) +
  geom_point() +
  facet_wrap(~ cyl)

ggsave_autopage_docx(
  plot = p,
  file_stem = "mtcars_facet",
  page_width = 6.5, page_height = 9.0,
  max_col = 4, max_row = 5
)
}

}
