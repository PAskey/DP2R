% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/find_region_wmu.R
\name{find_region_wmu}
\alias{find_region_wmu}
\title{Find WMU, Region, and RegionName from coordinates with WBID fallback}
\usage{
find_region_wmu(
  lon = NULL,
  lat = NULL,
  WBID = NULL,
  wmu = NULL,
  lakes_fetch = NULL,
  join = c("intersects", "within"),
  crs_in = 4326,
  crs_work = 3005,
  lakes_wbid_field = "WATERBODY_KEY_GROUP_CODE_50K",
  wmu_id_field = "Management_Unit",
  region_field = "region",
  region_name_field = "RegionName"
)
}
\arguments{
\item{lon}{Numeric vector of longitudes (EPSG:4326).}

\item{lat}{Numeric vector of latitudes (EPSG:4326).}

\item{WBID}{Character vector of WBIDs (expected to match FWA \code{WATERBODY_KEY_GROUP_CODE_50K}).}

\item{wmu}{Optional \code{sf} WMU polygon layer. If NULL, fetched via \pkg{bcdata}.}

\item{join}{Spatial predicate, one of \code{"intersects"} or \code{"within"}. Default \code{"intersects"}.}

\item{crs_in}{EPSG for input coords (default 4326).}

\item{crs_work}{EPSG for spatial work (default 3005).}

\item{lakes_wbid_field}{Field in lakes layer containing WBID (default \code{"WATERBODY_KEY_GROUP_CODE_50K"}).}

\item{wmu_id_field}{Column in \code{wmu} holding WMU id (default \code{"Management_Unit"}).}

\item{region_field}{Column in \code{wmu} holding region id (default \code{"region"}).}

\item{region_name_field}{Column in \code{wmu} holding region name (default \code{"RegionName"}).}

\item{lakes_record}{BC Data record for FWA lakes (default \code{"freshwater-atlas-lakes"}).}

\item{wbid_chunk_size}{Max WBIDs per WFS request (default 400; reduce to 100 if service is flaky).}
}
\value{
A \code{data.frame} with columns: \code{wmu}, \code{region}, \code{RegionName}.
  Same number of rows as the longest input among \code{lon/lat/WBID}.
}
\description{
Efficiently populates Wildlife Management Unit (WMU) and associated region fields.
Uses WGS84 coordinates first (fast point-in-polygon), then fills remaining gaps using
WBID -> Freshwater Atlas lake polygons (server-side filtered) -> WMU.
}
\details{
Designed for vectorized use on a whole column. Handles "fake" WBIDs by leaving
fallback results as NA (but still uses coords if present).
}
